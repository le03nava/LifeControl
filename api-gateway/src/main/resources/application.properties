# ============================================
# API Gateway - Configuración Parametrizada
# ============================================

# Configuración Básica
spring.application.name=${SPRING_APP_NAME:api-gateway}
server.port=${SERVER_PORT:9000}
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}

# Autenticación OAuth2
spring.security.oauth2.resourceserver.jwt.issuer-uri=${KEYCLOAK_ISSUER_URI:http://localhost:8181/realms/life-control-realm}

# Documentación Swagger/OpenAPI
springdoc.swagger-ui.path=${SWAGGER_UI_PATH:/swagger-ui.html}
springdoc.api-docs.path=${API_DOCS_PATH:/api-docs}
springdoc.swagger-ui.urls[0].name=${PRODUCT_SERVICE_NAME:Product Service}
springdoc.swagger-ui.urls[0].url=${PRODUCT_SERVICE_URL:/aggregate/product-service/v3/api-docs}
springdoc.swagger-ui.urls[1].name=${ORDER_SERVICE_NAME:Order Service}
springdoc.swagger-ui.urls[1].url=${ORDER_SERVICE_URL:/aggregate/order-service/v3/api-docs}
springdoc.swagger-ui.urls[2].name=${INVENTORY_SERVICE_NAME:Inventory Service}
springdoc.swagger-ui.urls[2].url=${INVENTORY_SERVICE_URL:/aggregate/inventory-service/v3/api-docs}
springdoc.swagger-ui.urls[3].name=${LIFECONTROL_API_NAME:LifeControl API}
springdoc.swagger-ui.urls[3].url=${LIFECONTROL_API_URL:/aggregate/lifecontrol-api/v3/api-docs}

# Actuator Endpoints
management.health.circuitbreakers.enabled=${CIRCUIT_BREAKER_ENABLED:true}
management.endpoints.web.exposure.include=${ACTUATOR_ENDPOINTS:*}
management.endpoint.health.show-details=${HEALTH_SHOW_DETAILS:always}
management.server.port=${MANAGEMENT_PORT:${SERVER_PORT:9000}}

# Monitoring & Tracing
management.metrics.export.prometheus.enabled=${PROMETHEUS_ENABLED:true}
management.tracing.enabled=${TRACING_ENABLED:true}
management.tracing.sampling.probability=${TRACING_SAMPLING_PROBABILITY:0.1}
logging.level.root=${LOG_LEVEL:INFO}
logging.pattern.console=${LOG_PATTERN:%d{yyyy-MM-dd HH:mm:ss} - %msg%n}

# Resilience4J - Circuit Breaker
resilience4j.circuitbreaker.configs.default.registerHealthIndicator=${CIRCUIT_BREAKER_HEALTH_INDICATOR:true}
resilience4j.circuitbreaker.configs.default.slidingWindowType=${CIRCUIT_BREAKER_WINDOW_TYPE:COUNT_BASED}
resilience4j.circuitbreaker.configs.default.slidingWindowSize=${CIRCUIT_BREAKER_WINDOW_SIZE:10}
resilience4j.circuitbreaker.configs.default.failureRateThreshold=${CIRCUIT_BREAKER_FAILURE_THRESHOLD:50}
resilience4j.circuitbreaker.configs.default.waitDurationInOpenState=${CIRCUIT_BREAKER_WAIT_DURATION:5s}
resilience4j.circuitbreaker.configs.default.permittedNumberOfCallsInHalfOpenState=${CIRCUIT_BREAKER_HALF_OPEN_CALLS:3}
resilience4j.circuitbreaker.configs.default.automaticTransitionFromOpenToHalfOpenEnabled=${CIRCUIT_BREAKER_AUTO_TRANSITION:true}
resilience4j.circuitbreaker.configs.default.minimumNumberOfCalls=${CIRCUIT_BREAKER_MIN_CALLS:5}

# Resilience4J - Timeout
resilience4j.timelimiter.configs.default.timeout-duration=${TIMEOUT_DURATION:3s}

# Resilience4J - Retry
resilience4j.retry.configs.default.maxAttempts=${RETRY_MAX_ATTEMPTS:3}
resilience4j.retry.configs.default.waitDuration=${RETRY_WAIT_DURATION:2s}

# Logging Configuration for Loki
loki.url=${LOKI_URL:http://loki:3100/loki/api/v1/push}
loki.batchSize=${LOKI_BATCH_SIZE:1000}
loki.timeout=${LOKI_TIMEOUT:10s}

# Health Check Configuration
health.check.enabled=${HEALTH_CHECK_ENABLED:true}
health.check.path=${HEALTH_CHECK_PATH:/actuator/health}
