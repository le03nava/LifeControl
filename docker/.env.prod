# ============================================
# LifeControl - Production Environment
# ============================================

# Environment
COMPOSE_PROJECT_NAME=lifecontrol-prod
ENVIRONMENT=production
SPRING_PROFILES_ACTIVE=prod

# ============================================
# PORTS - Production Ports (Offset +200)
# ============================================
MONGO_PORT=27217
MYSQL_PORT=3507
POSTGRES_PORT=5453
ZOOKEEPER_PORT=2381
KAFKA_PORT=9292
KAFKA_INTERNAL_PORT=29292
SCHEMA_REGISTRY_PORT=8285
KAFKA_UI_PORT=8386
KEYCLOAK_PORT=8381
WEB_APP_PORT=4420
API_GATEWAY_PORT=9200
LOKI_PORT=3300
PROMETHEUS_PORT=9290
TEMPO_PORT=3310
TEMPO_ZIPKIN_PORT=9611
GRAFANA_PORT=3200

# ============================================
# DATABASE CREDENTIALS - Production (Use secrets file)
# ============================================
MONGO_ROOT_USERNAME=root
MONGO_ROOT_PASSWORD_FILE=/run/secrets/mongo_root_password
MONGO_DATABASE=product-service

MYSQL_ROOT_PASSWORD_FILE=/run/secrets/mysql_root_password
MYSQL_DATABASE=order-service
MYSQL_USER=orderuser
MYSQL_PASSWORD_FILE=/run/secrets/mysql_password

# PostgreSQL - Product Service Database
PRODUCT_POSTGRES_PORT=5454
PRODUCT_POSTGRES_DB=product_service
PRODUCT_POSTGRES_USER=product_user
PRODUCT_POSTGRES_PASSWORD_FILE=/run/secrets/product_postgres_password

KEYCLOAK_POSTGRES_DB=keycloak_production
KEYCLOAK_POSTGRES_USER=keycloak
KEYCLOAK_POSTGRES_PASSWORD_FILE=/run/secrets/keycloak_postgres_password

# ============================================
# KEYCLOAK CONFIGURATION - Production
# ============================================
KC_DB=postgres
KC_DB_URL=jdbc:postgresql://keycloak-postgres/keycloak_production
KC_DB_USERNAME=keycloak
KC_DB_PASSWORD_FILE=/run/secrets/keycloak_postgres_password
KC_HOSTNAME=auth.lifecontrol.com
KC_HTTP_PORT=8080
KC_HTTPS_PORT=8443
KC_ADMIN_USERNAME=admin
KC_ADMIN_PASSWORD_FILE=/run/secrets/keycloak_admin_password

# ============================================
# FRONTEND KEYCLOAK CONFIGURATION - Production
# ============================================
KEYCLOAK_URL=https://auth.lifecontrol.com
KEYCLOAK_REALM=life-control-realm
KEYCLOAK_CLIENT_ID=life-control-client
# ============================================
# API GATEWAY CONFIGURATION - Frontend
# ============================================
API_GATEWAY_URL=http://api-gateway:9200
API_BASE_PATH=/api/product

# ============================================
# DOCKER IMAGES - Production stable versions
# ============================================
MONGO_IMAGE=mongo:7.0.5
MYSQL_IMAGE=mysql:8.3.0
POSTGRES_IMAGE=postgres:18.1

ZOOKEEPER_IMAGE=confluentinc/cp-zookeeper:7.5.0
KAFKA_IMAGE=confluentinc/cp-kafka:7.5.0
SCHEMA_REGISTRY_IMAGE=confluentinc/cp-schema-registry:7.5.0
KAFKA_UI_IMAGE=kafbat/kafka-ui:latest

KEYCLOAK_IMAGE=quay.io/keycloak/keycloak:26.2.1
LOKI_IMAGE=grafana/loki:2.9.0
PROMETHEUS_IMAGE=prom/prometheus:v2.48.0
GRAFANA_IMAGE=grafana/grafana:10.2.0
TEMPO_IMAGE=grafana/tempo:2.3.0

# ============================================
# KAFKA CONFIGURATION - Production
# ============================================
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://broker:29292,PLAINTEXT_HOST://localhost:9292
KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=3
KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=2
KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=3

SCHEMA_REGISTRY_HOST_NAME=schema-registry
SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS=broker:29292
SCHEMA_REGISTRY_LISTENERS=http://schema-registry:8081

KAFKA_CLUSTERS_NAME=production
KAFKA_CLUSTERS_BOOTSTRAPSERVERS=broker:29292

# ============================================
# API GATEWAY CONFIGURATION - Production
# ============================================
API_GATEWAY_SERVER_PORT=9200
API_GATEWAY_MANAGEMENT_PORT=9201
KEYCLOAK_ISSUER_URI=https://auth.lifecontrol.com/realms/life-control-realm

# ============================================
# PRODUCT SERVICE CONFIGURATION - Production
# ============================================
PRODUCT_SERVICE_PORT=8080
PRODUCT_SERVICE_MANAGEMENT_PORT=8081
DATABASE_URL=jdbc:postgresql://product-postgres:5432/product_service
DATABASE_USERNAME=product_user
DATABASE_PASSWORD_FILE=/run/secrets/product_postgres_password

# Circuit Breaker - Robust for production
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=50
CIRCUIT_BREAKER_WINDOW_SIZE=20
TIMEOUT_DURATION=5s
RETRY_MAX_ATTEMPTS=3

# Logging - Minimal for production
LOG_LEVEL=WARN
TRACING_ENABLED=true
TRACING_SAMPLING_PROBABILITY=0.01

# ============================================
# MONITORING CONFIGURATION - Production
# ============================================
PROMETHEUS_ENABLED=true
LOKI_URL=http://loki:3300/loki/api/v1/push

# Health Checks - Robust for production
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=5s
HEALTH_CHECK_START_PERIOD=120s
HEALTH_CHECK_RETRIES=5

# ============================================
# GRAFANA CONFIGURATION - Production (Secure)
# ============================================
GF_AUTH_ANONYMOUS_ENABLED=false
GF_AUTH_BASIC_ENABLED=true
GF_AUTH_DISABLE_LOGIN_FORM=false

# ============================================
# VOLUMES PATHS - Production
# ============================================
VOLUMES_BASE_PATH=/var/lib/lifecontrol/volumes
MONGO_DATA_PATH=/var/lib/lifecontrol/volumes/mongodb/data
MYSQL_DATA_PATH=/var/lib/lifecontrol/volumes/mysql/data
POSTGRES_DATA_PATH=/var/lib/lifecontrol/volumes/postgres/data
KEYCLOAK_REALMS_PATH=/var/lib/lifecontrol/volumes/keycloak/realms
PROMETHEUS_DATA_PATH=/var/lib/lifecontrol/volumes/prometheus/data
PROMETHEUS_CONFIG_PATH=/var/lib/lifecontrol/volumes/prometheus/config
TEMPO_DATA_PATH=/var/lib/lifecontrol/volumes/tempo/data
TEMPO_CONFIG_PATH=/var/lib/lifecontrol/volumes/tempo/config
GRAFANA_DATA_PATH=/var/lib/lifecontrol/volumes/grafana/data
GRAFANA_CONFIG_PATH=/var/lib/lifecontrol/volumes/grafana/config
LOKI_DATA_PATH=/var/lib/lifecontrol/volumes/loki/data
LOKI_CONFIG_PATH=/var/lib/lifecontrol/volumes/loki/config
KAFKA_DATA_PATH=/var/lib/lifecontrol/volumes/kafka/data
MYSQL_INIT_PATH=/var/lib/lifecontrol/volumes/mysql/init

# ============================================
# RESOURCE LIMITS - Production (High)
# ============================================
MONGO_MEMORY_LIMIT=2g
MYSQL_MEMORY_LIMIT=2g
POSTGRES_MEMORY_LIMIT=2g
PRODUCT_POSTGRES_MEMORY_LIMIT=1g
KAFKA_MEMORY_LIMIT=4g
KEYCLOAK_MEMORY_LIMIT=2g
API_GATEWAY_MEMORY_LIMIT=2g
PRODUCT_SERVICE_MEMORY_LIMIT=1g
PROMETHEUS_MEMORY_LIMIT=2g
GRAFANA_MEMORY_LIMIT=1g
TEMPO_MEMORY_LIMIT=2g
LOKI_MEMORY_LIMIT=1g

# ============================================
# NETWORK CONFIGURATION
# ============================================
NETWORK_NAME=lifecontrol-network-prod
NETWORK_DRIVER=bridge

# ============================================
# SECURITY - Production Settings
# ============================================
COMPOSE_DOCKER_CLI_BUILD=1
DOCKER_BUILDKIT=1
