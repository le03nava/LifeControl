# ============================================
# LifeControl - Staging Environment
# ============================================

# Environment
COMPOSE_PROJECT_NAME=lifecontrol-staging
ENVIRONMENT=staging
SPRING_PROFILES_ACTIVE=staging

# ============================================
# PORTS - Staging Ports (Offset +100)
# ============================================
MONGO_PORT=27117
MYSQL_PORT=3407
POSTGRES_PORT=5443
ZOOKEEPER_PORT=2281
KAFKA_PORT=9192
KAFKA_INTERNAL_PORT=29192
SCHEMA_REGISTRY_PORT=8185
KAFKA_UI_PORT=8286
KEYCLOAK_PORT=8281
WEB_APP_PORT=4320
API_GATEWAY_PORT=9100
LOKI_PORT=3200
PROMETHEUS_PORT=9190
TEMPO_PORT=3210
TEMPO_ZIPKIN_PORT=9511
GRAFANA_PORT=3100

# ============================================
# DATABASE CREDENTIALS - Staging (Use secrets in production)
# ============================================
MONGO_ROOT_USERNAME=root
MONGO_ROOT_PASSWORD=${STAGING_MONGO_PASSWORD}
MONGO_DATABASE=product-service

MYSQL_ROOT_PASSWORD=${STAGING_MYSQL_PASSWORD}
MYSQL_DATABASE=order-service
MYSQL_USER=orderuser
MYSQL_PASSWORD=${STAGING_MYSQL_PASSWORD}

# PostgreSQL - Product Service Database
PRODUCT_POSTGRES_PORT=5444
PRODUCT_POSTGRES_DB=product_service
PRODUCT_POSTGRES_USER=product_user
PRODUCT_POSTGRES_PASSWORD=${STAGING_PRODUCT_POSTGRES_PASSWORD}

KEYCLOAK_POSTGRES_DB=keycloak_staging
KEYCLOAK_POSTGRES_USER=keycloak
KEYCLOAK_POSTGRES_PASSWORD=${STAGING_KEYCLOAK_POSTGRES_PASSWORD}

# ============================================
# KEYCLOAK CONFIGURATION - Staging
# ============================================
KC_DB=postgres
KC_DB_URL=jdbc:postgresql://keycloak-postgres/keycloak_staging
KC_DB_USERNAME=keycloak
KC_DB_PASSWORD=${STAGING_KEYCLOAK_POSTGRES_PASSWORD}
KC_HOSTNAME=staging.lifecontrol.local
KC_HTTP_PORT=8080
KC_ADMIN_USERNAME=admin
KC_ADMIN_PASSWORD=${STAGING_KC_ADMIN_PASSWORD}

# ============================================
# FRONTEND KEYCLOAK CONFIGURATION - Staging
# ============================================
KEYCLOAK_URL=http://staging.lifecontrol.local:8281
KEYCLOAK_REALM=life-control-realm
KEYCLOAK_CLIENT_ID=life-control-client
# ============================================
# API GATEWAY CONFIGURATION - Frontend
# ============================================
API_GATEWAY_URL=http://staging.lifecontrol.local:9100
API_BASE_PATH=/api/product

# ============================================
# DOCKER IMAGES - Stable versions for staging
# ============================================
MONGO_IMAGE=mongo:7.0.5
MYSQL_IMAGE=mysql:8.3.0
POSTGRES_IMAGE=postgres:18.1

ZOOKEEPER_IMAGE=confluentinc/cp-zookeeper:7.5.0
KAFKA_IMAGE=confluentinc/cp-kafka:7.5.0
SCHEMA_REGISTRY_IMAGE=confluentinc/cp-schema-registry:7.5.0
KAFKA_UI_IMAGE=kafbat/kafka-ui:latest

KEYCLOAK_IMAGE=quay.io/keycloak/keycloak:26.2.1
LOKI_IMAGE=grafana/loki:2.9.0
PROMETHEUS_IMAGE=prom/prometheus:v2.48.0
GRAFANA_IMAGE=grafana/grafana:10.2.0
TEMPO_IMAGE=grafana/tempo:2.3.0

# ============================================
# KAFKA CONFIGURATION
# ============================================
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://broker:29192,PLAINTEXT_HOST://localhost:9192
KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1
KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1

SCHEMA_REGISTRY_HOST_NAME=schema-registry
SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS=broker:29192
SCHEMA_REGISTRY_LISTENERS=http://schema-registry:8081

KAFKA_CLUSTERS_NAME=staging
KAFKA_CLUSTERS_BOOTSTRAPSERVERS=broker:29192

# ============================================
# API GATEWAY CONFIGURATION - Staging
# ============================================
API_GATEWAY_SERVER_PORT=9100
API_GATEWAY_MANAGEMENT_PORT=9101
KEYCLOAK_ISSUER_URI=http://staging.lifecontrol.local:8281/realms/life-control-realm

# ============================================
# PRODUCT SERVICE CONFIGURATION - Staging
# ============================================
PRODUCT_SERVICE_PORT=8080
PRODUCT_SERVICE_MANAGEMENT_PORT=8081
DATABASE_URL=jdbc:postgresql://product-postgres:5432/product_service
DATABASE_USERNAME=product_user
DATABASE_PASSWORD=${STAGING_PRODUCT_POSTGRES_PASSWORD}

# Circuit Breaker - Moderate for staging
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=40
CIRCUIT_BREAKER_WINDOW_SIZE=10
TIMEOUT_DURATION=3s
RETRY_MAX_ATTEMPTS=3

# Logging - Moderate for staging
LOG_LEVEL=INFO
TRACING_ENABLED=true
TRACING_SAMPLING_PROBABILITY=0.05

# ============================================
# MONITORING CONFIGURATION
# ============================================
PROMETHEUS_ENABLED=true
LOKI_URL=http://loki:3200/loki/api/v1/push

# Health Checks - Balanced
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=20s
HEALTH_CHECK_TIMEOUT=3s
HEALTH_CHECK_START_PERIOD=60s
HEALTH_CHECK_RETRIES=3

# ============================================
# GRAFANA CONFIGURATION - Staging
# ============================================
GF_AUTH_ANONYMOUS_ENABLED=true
GF_AUTH_ANONYMOUS_ORG_ROLE=Admin
GF_AUTH_DISABLE_LOGIN_FORM=true

# ============================================
# VOLUMES PATHS - Standardized
# ============================================
VOLUMES_BASE_PATH=./docker-staging
MONGO_DATA_PATH=./docker-staging/mongodb/volumes/data
MYSQL_DATA_PATH=./docker-staging/mysql/volumes/data
POSTGRES_DATA_PATH=./docker-staging/postgres/volumes/data
KEYCLOAK_REALMS_PATH=./docker-staging/keycloak/volumes/realms
PROMETHEUS_DATA_PATH=./docker-staging/prometheus/volumes/data
PROMETHEUS_CONFIG_PATH=./docker-staging/prometheus/volumes/config
TEMPO_DATA_PATH=./docker-staging/tempo/volumes/data
TEMPO_CONFIG_PATH=./docker-staging/tempo/volumes/config
GRAFANA_DATA_PATH=./docker-staging/grafana/volumes/data
GRAFANA_CONFIG_PATH=./docker-staging/grafana/volumes/config
LOKI_DATA_PATH=./docker-staging/loki/volumes/data
LOKI_CONFIG_PATH=./docker-staging/loki/volumes/config
KAFKA_DATA_PATH=./docker-staging/kafka/volumes/data
MYSQL_INIT_PATH=./docker-staging/mysql/volumes/init

# ============================================
# RESOURCE LIMITS - Staging (Medium)
# ============================================
MONGO_MEMORY_LIMIT=1g
MYSQL_MEMORY_LIMIT=1g
POSTGRES_MEMORY_LIMIT=1g
PRODUCT_POSTGRES_MEMORY_LIMIT=512m
KAFKA_MEMORY_LIMIT=2g
KEYCLOAK_MEMORY_LIMIT=2g
API_GATEWAY_MEMORY_LIMIT=1g
PRODUCT_SERVICE_MEMORY_LIMIT=512m
PROMETHEUS_MEMORY_LIMIT=1g
GRAFANA_MEMORY_LIMIT=512m
TEMPO_MEMORY_LIMIT=1g
LOKI_MEMORY_LIMIT=512m

# ============================================
# NETWORK CONFIGURATION
# ============================================
NETWORK_NAME=lifecontrol-network-staging
NETWORK_DRIVER=bridge
